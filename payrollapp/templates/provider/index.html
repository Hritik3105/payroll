{% extends 'layout/admin.html' %}

{% block title %} Due {% endblock %}


{% block content %}

<div class="content-wrapper">

  <!-- Content -->
  
    <div class="container-xxl flex-grow-1 container-p-y">
      
      
<h4 class="py-3 breadcrumb-wrapper mb-4">
<span class="text-muted fw-light"></span> Provider Parameter 
</h4>
<div class="row-fluid">

</div>
<!-- Ajax Sourced Server-side -->
<div class="card">
<h5 class="card-header"> Provider Parameter </h5>
<div class="card-datatable text-nowrap">
<table class="datatables-ajax table table-bordered" id="datatables">
<thead>
  <tr>
    <td hidden >id</td>
    <th>ID Fiscal</th>
    <th>VAT ID</th>
    <th>Bank Account</th>
    <th>Bank Beneficiary</th>
    <th>Bank Code</th>
    <th>Payment Term</th>
    <th>Email Notification</th>
    <th>Action</th>
  </tr>
</thead>
<tbody>    
  {%for j in pro %}         
  <tr>
    <td hidden>{{j.id}}</td>
      <td>{{j.provider_name}}</td>
      <td>{{j.provider_name}}</td> 
      <td>2390555000</td>
      <td><select name="cars" id="cars" class="cars">
        <option value="{{forloop.counter}}" data-sync="{{forloop.counter}}">Select Bank</option>
        {% for i in bank %}
        {%if i.bank_name == j.bank_name%}
        <option value="{{forloop.counter}}" data-sync="{{forloop.counter}}" selected>{{j.bank_name}}</option>
        {%else%}
        <option value="{{forloop.counter}}" data-sync="{{forloop.counter}}">{{i.bank_name}}</option>
        {%endif%}
        {%endfor%}
      </select></td>
        
      {%if j.bank_code%}
      <td id="val">{{j.bank_code}}
      {%else%}
      <td id="val">
      {%endif%}
        
    </td> 
     
   
     
      {% comment %} <td id ="val"></td> {% endcomment %}
    
      <td>30</td>
      <td>example@gmail.com</td>
      <td> <input type='button' class='myclass'  value='save'  onclick='myTest(this)'/>
        <!-- <i class="" style="font-size:28px;color:green">save</i>
      </a> -->
     
      <!-- <a href="" class="btn text-secondary px-0">
        <i class="fa fa-save" aria-hidden="true" style="font-size:28px;color:blue;"></i> -->
        <!-- <i class="fa fa-trash-o danger " style="font-size:28px;color:red;"></i> -->
      <!-- </a> -->
    </td>
    
  </tr>
  {%endfor%}
 



     

</tbody>
</table>
</div>
</div>
<!--/ Ajax Sourced Server-side -->


  

{% endblock content %}


{% block javascripts %}
  {{ block.super }}

  <script>
    $(document).ready(function() {
        $('#datatables').DataTable( {
          scrollX: true,
        
          
           
        });
    });
    </script>
  
  <script>

$(".cars").change(function(){
  
  const element = document.getElementById("cars");
  const checkText = element.options[element.selectedIndex].text;
  var currentRow=$(this).closest("tr");
  console.log("hello1",currentRow)

  var bank_name = currentRow.find("#cars option:selected").html();
  console.log("fgggggggggggggggggggg",bank_name)
  var value = $('select#cars option:selected').val();
  console.log("hello2",value)
  
  var rr = currentRow.find("#cars option:selected").val();
  console.log("hello3",(rr))
  
  $.ajax({
        type:"GET",
        url: '/insurance/update-insurance-status/',
        data: {
          'id': rr
        },
        dataType: 'json',
        success: function (data) {
          var rr = currentRow.find("#val").html(data.id);
        }
     
      });

    });

    function myTest(a)
  {
    var currentRow=$(a).closest("tr");
  
    var bank_id = currentRow.find("td:eq(0)").html();
    var bank_name = currentRow.find("#cars option:selected").html();
 
    var bank_code = currentRow.find("td:eq(5)").html();
    {% comment %} var value = currentRow.find("#cars option:selected").html();
    console.log("hritik",value) {% endcomment %}
    // var value = $('select#cars option:selected').val();
    
    if(bank_name == "Select Bank"){
      alert("Please Select Bank");
    }
    else{
  
      alert("Bank data Saved Successfully");
  
    
    $.ajax({
          type:"GET",
          url: '/bank/details/',
          data: {
            'id': bank_id,
            'bank_name':bank_name,
            'bank_code':bank_code
          },
          dataType: 'json',
          success: function (data) {
            $('#cars option:selected').val(data.result);
            
          }
       
        });
  
    }
  
  }
{% comment %} 
$(document).ready(function() {
  
  $(".myclass").click(function () {
  console.log("Enter")
  
  var currentRow=$(this).closest("tr");
  
  var bank_id = currentRow.find("td:eq(0)").html();
  
  var bank_name = currentRow.find("#cars option:selected").html();
  
  var bank_code = currentRow.find("td:eq(5)").html();

  var value = $('select#cars option:selected').val();
  if(value == 0){
    alert("Please Select Bank");
  }
  else{

    alert("ok bank done");

  
  $.ajax({
        type:"GET",
        url: '/bank/details/',
        data: {
          'id': bank_id,
          'bank_name':bank_name,
          'bank_code':bank_code
        },
        dataType: 'json',
        success: function (data) {
          $('#cars option:selected').val(data.result);
          
        }
     
      });

  }


  });
}); {% endcomment %}



//     window.onchange=function() {
//     let monthData = `{{js}}`;
//     console.log(monthData)
//     let zz=Number(monthData)
//     for (let i = 1; i < zz +1; i++) {
//       console.log("sdfdg",i)
    
//     document.getElementById(String(i)).onchange=function() {
   
//     document.getElementById("hri"+String(i)).value=this.options[this.selectedIndex].getAttribute("data-sync"); 
//   }
//     document.getElementById(String(i)).onchange(); // trigger when loading
// } 

// }

  </script>



{% endblock javascripts %}